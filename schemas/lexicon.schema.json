{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$title": "Cozy Game Lexicon Schema",
  "$id": "https://example.com/schemas/lexicon.schema.json",
  "type": "object",
  "additionalProperties": false,
  "required": ["lexicon"],
  "properties": {
    "lexicon": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/lexicon_entry" }
    }
  },
  "$defs": {
    "slug_id": {
      "type": "string",
      "pattern": "^[a-z0-9_]+$",
      "description": "Lowercase snake_case identifier."
    },
    "lexicon_type": {
      "type": "string",
      "enum": ["Sensory", "Light", "Emotion", "Not_Allowed", "Tone", "Meta"],
      "description": "High-level lexicon category."
    },
    "scope": {
      "description": "Where this lexicon entry applies.",
      "oneOf": [
        { "type": "string", "enum": ["Global"] },
        { "$ref": "#/$defs/slug_id" }
      ]
    },
    "allowed_words": {
      "description": "Allowed or disallowed words/phrases.",
      "oneOf": [
        { "type": "string", "minLength": 1 },
        { "type": "array", "minItems": 1, "items": { "type": "string" }, "uniqueItems": true }
      ]
    },
    "lexicon_entry": {
      "type": "object",
      "additionalProperties": false,
      "required": ["lexicon_type", "key", "scope"],
      "properties": {
        "lexicon_type": { "$ref": "#/$defs/lexicon_type" },
        "key": {
          "type": "string",
          "minLength": 1,
          "description": "Logical key for the lexicon entry. Examples: smell_bakery, sight_forest, time_Morning, threat_words"
        },
        "scope": {
          "$ref": "#/$defs/scope",
          "description": "Either 'Global' or a Place_ID. Place_ID must correspond to the Places table (validated separately)."
        },
        "extends": {
          "type": ["string", "null"],
          "default": null,
          "description": "Optional alias to another lexicon entry key. If provided, this entry reuses the referenced entry's words. Tooling should resolve chains; avoid cycles."
        },
        "words": { "$ref": "#/$defs/allowed_words" },
        "notes": {
          "type": ["string", "null"],
          "default": null,
          "description": "Optional human-facing explanation or rationale."
        }
      },
      "allOf": [
        {
          "oneOf": [
            { "required": ["words"] },
            { "required": ["extends"] }
          ]
        }
      ]
    }
  }
}